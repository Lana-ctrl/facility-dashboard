<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facility Inspection Dashboard 2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a1f3b 0%, #1e3a5f 100%);
            padding: 30px;
            min-height: 100vh;
        }
        
        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            grid-gap: 25px;
        }
        
        .dashboard-header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #0b2b4a 0%, #1c4e6c 100%);
            color: white;
            padding: 30px 35px;
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 6px solid #4ecdc4;
        }
        
        .header-title h1 {
            font-size: 34px;
            font-weight: 800;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .header-title p {
            font-size: 18px;
            opacity: 0.95;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .header-badge {
            background-color: #4ecdc4;
            color: #0a1f3b;
            padding: 8px 18px;
            border-radius: 40px;
            font-weight: 800;
            font-size: 14px;
            letter-spacing: 0.5px;
        }
        
        .header-date {
            background: rgba(255, 255, 255, 0.12);
            padding: 15px 25px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .card:hover {
            transform: translateY(-6px);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.15);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #edf2f7;
        }
        
        .card-title {
            font-size: 20px;
            font-weight: 800;
            color: #0b2b4a;
            letter-spacing: -0.3px;
        }
        
        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            background: linear-gradient(135deg, #0b2b4a 0%, #1c4e6c 100%);
        }
        
        .summary-cards {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            grid-gap: 25px;
            margin-bottom: 10px;
        }
        
        .summary-card {
            text-align: center;
            padding: 28px 20px;
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }
        
        .summary-value {
            font-size: 48px;
            font-weight: 800;
            margin: 15px 0;
            color: #0b2b4a;
        }
        
        .summary-label {
            font-size: 16px;
            color: #4a5568;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .chart-container {
            grid-column: span 8;
            height: 350px;
        }
        
        .status-container {
            grid-column: span 4;
        }
        
        .locations-container {
            grid-column: span 6;
        }
        
        .progress-container {
            grid-column: span 6;
        }
        
        .progress-item {
            margin-bottom: 22px;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .progress-bar {
            height: 12px;
            background-color: #e2e8f0;
            border-radius: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 20px;
            transition: width 0.8s ease;
        }
        
        .location-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .location-item {
            display: flex;
            justify-content: space-between;
            padding: 14px 18px;
            margin-bottom: 10px;
            background-color: #f8fafc;
            border-radius: 14px;
            border-left: 6px solid #0b2b4a;
            transition: all 0.2s ease;
        }
        
        .location-item:hover {
            background-color: #edf2f7;
            transform: translateX(5px);
        }
        
        .location-name {
            font-weight: 700;
            color: #1a202c;
        }
        
        .location-count {
            background-color: #0b2b4a;
            color: white;
            padding: 4px 14px;
            border-radius: 30px;
            font-size: 13px;
            font-weight: 700;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            margin-bottom: 18px;
            padding: 18px;
            border-radius: 16px;
            background-color: #f8fafc;
        }
        
        .status-indicator {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            margin-right: 18px;
        }
        
        .status-details {
            flex-grow: 1;
        }
        
        .status-name {
            font-weight: 700;
            margin-bottom: 5px;
            color: #2d3748;
        }
        
        .status-count {
            font-size: 26px;
            font-weight: 800;
            color: #0b2b4a;
        }
        
        .pending-list {
            grid-column: span 12;
            margin-top: 10px;
        }
        
        .task-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .task-table th {
            text-align: left;
            padding: 16px 15px;
            background-color: #0b2b4a;
            color: white;
            font-weight: 700;
            font-size: 14px;
        }
        
        .task-table td {
            padding: 14px 15px;
            border-bottom: 1px solid #e2e8f0;
            vertical-align: middle;
        }
        
        .task-table tr:hover {
            background-color: #f7fafc;
        }
        
        .status-badge {
            padding: 6px 14px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
        }
        
        .status-completed {
            background-color: #c6f6d5;
            color: #22543d;
        }
        
        .status-inprogress {
            background-color: #feebc8;
            color: #7b341e;
        }
        
        .owner-badge {
            padding: 6px 14px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            background-color: #e6f0fa;
            color: #0b2b4a;
        }
        
        .drive-link {
            color: #0b2b4a;
            font-size: 16px;
            transition: all 0.2s;
        }
        
        .drive-link:hover {
            color: #4ecdc4;
            transform: scale(1.1);
        }
        
        .filter-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-tab {
            padding: 10px 20px;
            border-radius: 40px;
            background-color: #edf2f7;
            font-weight: 600;
            font-size: 14px;
            color: #4a5568;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }
        
        .filter-tab.active {
            background-color: #0b2b4a;
            color: white;
        }
        
        .filter-tab:hover {
            background-color: #cbd5e0;
        }
        
        .filter-tab.active:hover {
            background-color: #1c4e6c;
        }
        
        .verification-badge {
            background-color: #4ecdc4;
            color: #0a1f3b;
            padding: 4px 10px;
            border-radius: 30px;
            font-size: 11px;
            font-weight: 800;
            display: inline-block;
        }
        
        .footer {
            grid-column: 1 / -1;
            text-align: center;
            padding: 25px;
            color: white;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        
        @media (max-width: 1200px) {
            .chart-container, .status-container {
                grid-column: span 12;
            }
            .locations-container, .progress-container {
                grid-column: span 6;
            }
        }
        
        @media (max-width: 768px) {
            .summary-cards {
                grid-template-columns: 1fr;
            }
            .locations-container, .progress-container {
                grid-column: span 12;
            }
            .dashboard-header {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="dashboard-header">
            <div class="header-title">
                <h1><i class="fas fa-clipboard-check"></i> Facility Inspection Dashboard 2026</h1>
                <p>
                    <span class="header-badge">
                        <i class="fas fa-check-circle"></i> HS HQ Offices
                    </span>
                    <span><i class="fas fa-map-marker-alt"></i> 32 Active Locations</span>
                    <span><i class="fas fa-camera"></i> 25+ Photo Records</span>
                </p>
            </div>
            <div class="header-date">
                <i class="far fa-calendar-alt"></i> Last Updated: February 12, 2026
                <div style="font-size: 13px; margin-top: 6px; opacity: 0.9;">üì∏ Before/After photos available</div>
            </div>
        </div>
        
        <div class="summary-cards">
            <div class="card summary-card">
                <div class="card-icon" style="background: linear-gradient(135deg, #0b2b4a 0%, #1c4e6c 100%); margin: 0 auto;">
                    <i class="fas fa-tasks"></i>
                </div>
                <div class="summary-value" id="total-tasks">73</div>
                <div class="summary-label">Total Inspection Items</div>
            </div>
            
            <div class="card summary-card">
                <div class="card-icon" style="background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); margin: 0 auto;">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="summary-value" id="completed-tasks">44</div>
                <div class="summary-label">Completed Actions</div>
                <div style="font-size: 13px; color: #2ecc71; margin-top: 8px; font-weight: 700;">60% Complete</div>
            </div>
            
            <div class="card summary-card">
                <div class="card-icon" style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); margin: 0 auto;">
                    <i class="fas fa-spinner"></i>
                </div>
                <div class="summary-value" id="inprogress-tasks">29</div>
                <div class="summary-label">In Progress Actions</div>
                <div style="font-size: 13px; color: #e67e22; margin-top: 8px; font-weight: 700;">40% Active</div>
            </div>
            
            <div class="card summary-card">
                <div class="card-icon" style="background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); margin: 0 auto;">
                    <i class="fas fa-image"></i>
                </div>
                <div class="summary-value" id="total-photos">18</div>
                <div class="summary-label">Photo Documentation</div>
                <div style="font-size: 13px; color: #8e44ad; margin-top: 8px; font-weight: 700;">Drive Links Active</div>
            </div>
        </div>
        
        <div class="card chart-container">
            <div class="card-header">
                <div class="card-title">üìä Task Completion Timeline</div>
                <div class="card-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
            </div>
            <canvas id="timelineChart"></canvas>
        </div>
        
        <div class="card status-container">
            <div class="card-header">
                <div class="card-title">üìà Status Overview</div>
                <div class="card-icon">
                    <i class="fas fa-chart-pie"></i>
                </div>
            </div>
            <div id="statusOverview">
                <div class="status-item">
                    <div class="status-indicator" style="background-color: #2ecc71; box-shadow: 0 0 10px rgba(46, 204, 113, 0.3);"></div>
                    <div class="status-details">
                        <div class="status-name">Completed</div>
                        <div class="status-count">44 Tasks</div>
                    </div>
                    <div style="font-size: 24px; font-weight: 800; color: #2ecc71;">60%</div>
                </div>
                <div class="status-item">
                    <div class="status-indicator" style="background-color: #f39c12; box-shadow: 0 0 10px rgba(243, 156, 18, 0.3);"></div>
                    <div class="status-details">
                        <div class="status-name">In Progress</div>
                        <div class="status-count">29 Tasks</div>
                    </div>
                    <div style="font-size: 24px; font-weight: 800; color: #f39c12;">40%</div>
                </div>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #f0f9ff; border-radius: 16px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-check-circle" style="color: #0b2b4a;"></i>
                    <span style="font-weight: 700;">Verification Rate:</span>
                    <span style="background: #0b2b4a; color: white; padding: 4px 12px; border-radius: 30px;">65% Verified</span>
                </div>
            </div>
        </div>
        
        <div class="card locations-container">
            <div class="card-header">
                <div class="card-title">üìç Top Locations by Tasks</div>
                <div class="card-icon">
                    <i class="fas fa-map-marked-alt"></i>
                </div>
            </div>
            <div class="location-list" id="topLocations"></div>
        </div>
        
        <div class="card progress-container">
            <div class="card-header">
                <div class="card-title">üë• Owner Progress</div>
                <div class="card-icon">
                    <i class="fas fa-users"></i>
                </div>
            </div>
            <div id="ownerProgress"></div>
            <div style="margin-top: 20px; padding: 15px; background: #f0f9ff; border-radius: 16px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-clock" style="color: #e67e22;"></i>
                    <span style="font-weight: 700;">Waiting on:</span>
                    <span style="background: #e67e22; color: white; padding: 4px 12px; border-radius: 30px;">Finance Approval (4)</span>
                    <span style="background: #3498db; color: white; padding: 4px 12px; border-radius: 30px;">Materials (3)</span>
                </div>
            </div>
        </div>
        
        <div class="card pending-list">
            <div class="card-header">
                <div class="card-title">‚è∞ Priority Tasks - Upcoming Deadlines</div>
                <div class="card-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
            </div>
            <div class="filter-tabs">
                <button class="filter-tab active" onclick="filterTasks('all')">All Tasks</button>
                <button class="filter-tab" onclick="filterTasks('overdue')">Overdue</button>
                <button class="filter-tab" onclick="filterTasks('today')">Due Today</button>
                <button class="filter-tab" onclick="filterTasks('week')">This Week</button>
            </div>
            <table class="task-table">
                <thead>
                    <tr>
                        <th>Action</th>
                        <th>Location</th>
                        <th>Owner</th>
                        <th>Status</th>
                        <th>ETA</th>
                        <th>Docs</th>
                    </tr>
                </thead>
                <tbody id="pendingTasks"></tbody>
            </table>
        </div>
        
        <div class="footer">
            <i class="fas fa-info-circle"></i> Facility Inspection Report ‚Ä¢ HS HQ Offices ‚Ä¢ 73 Total Tasks (44 Completed, 29 In Progress)
            <div style="margin-top: 12px; display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
                <span><i class="fas fa-square" style="color: #0b2b4a;"></i> Facility: 44 tasks</span>
                <span><i class="fas fa-square" style="color: #f39c12;"></i> Contractor: 11 tasks</span>
                <span><i class="fas fa-square" style="color: #3498db;"></i> Vendor: 5 tasks</span>
                <span><i class="fas fa-square" style="color: #e74c3c;"></i> Landlord: 2 tasks</span>
            </div>
        </div>
    </div>

    <script>
        // UPDATED INSPECTION DATA - February 2026
        const inspectionData = [
            { action: "Remove plastic protective covers from all new electrical sockets", location: "Alhareeq 1&2", owner: "Facility", status: "Completed", eta: "2026-02-08", verification: "Yes" },
            { action: "Repaint the new planter outside Alhareeq 1 and 2", location: "Alhareeq 1&2", owner: "Contractor", status: "In Progress", eta: "2026-02-07", comment: "The job is completed but the quality of the planters are very poor", verification: "Yes" },
            { action: "Repaint the step between Alhareeq and the outside area", location: "Alhareeq 1", owner: "Contractor", status: "Completed", eta: "", verification: "Yes" },
            { action: "Install protective metal plates on the toilet doors", location: "Alhareeq 1&2", owner: "Contractor", status: "Completed", eta: "", verification: "Yes" },
            { action: "Install anti-slip ramp stickers", location: "Alhareeq 2", owner: "Contractor", status: "Completed", eta: "", verification: "Yes" },
            { action: "Fill the gap below the wall paper in Alhareeq 1&2", location: "Alhareeq 1&2", owner: "Contractor", status: "Completed", eta: "", verification: "Yes" },
            { action: "Create and implement a checklist for the water purifier", location: "Alhareeq 1&2", owner: "Facility", status: "Completed", eta: "2026-02-09", verification: "Yes" },
            { action: "Fix the door gate to Alhareeq 1&2", location: "2nd floor corridor", owner: "Facility", status: "Completed", eta: "", verification: "Yes" },
            { action: "Brand the new door gate to Alhareeq 1&2", location: "2nd floor corridor", owner: "Facility", status: "In Progress", eta: "2026-02-14", verification: "" },
            { action: "Install 'No Smoking' sign in the rooftop", location: "Rooftop", owner: "Facility", status: "Completed", eta: "", verification: "Yes" },
            { action: "Remove cleaning chemicals under sinks", location: "Alhareeq 1&2", owner: "Facility", status: "Completed", eta: "2026-02-09", verification: "Yes" },
            { action: "Remove the paint stains in Alhareeq 1 and 2 toilets", location: "Alhareeq 1&2", owner: "Contractor", status: "Completed", eta: "2026-02-09", verification: "Yes" },
            { action: "Clean paint stains from electrical sockets", location: "Alhareeq 1", owner: "Facility", status: "Completed", eta: "2026-02-09", verification: "Yes" },
            { action: "Remove scratches from kitchen cabinets", location: "Alhareeq 1&2", owner: "Contractor", status: "Completed", eta: "2026-02-09", verification: "" },
            { action: "Remove cleaning materials from all toilets", location: "Alhareeq 1&2", owner: "Facility", status: "Completed", eta: "2026-02-08", verification: "Yes", afterPic: "https://drive.google.com/drive/folders/14PxWbOAIlQrNHAzE7-0yTWZijW4d9oi0" },
            { action: "Install electrical power connection for water dispensers", location: "Alhareeq 1&2", owner: "Contractor", status: "Completed", eta: "2026-02-08", verification: "Yes", afterPic: "https://drive.google.com/drive/folders/1DbqXwOj7iYMF-eEt3Bi-CU4rKU3IEDwt" },
            { action: "Reinstall the wallpaper in Alhareeq 1 and 2", location: "Alhareeq 1&2", owner: "Contractor", status: "Completed", eta: "2026-02-08", verification: "Yes", afterPic: "https://drive.google.com/drive/folders/12j7hzd274Dr4zsTxOdbSz8sBChO67AAQ" },
            { action: "Remove wall scratches caused by planters", location: "Alhareeq 2", owner: "Facility", status: "In Progress", eta: "2026-02-11", verification: "" },
            { action: "Remove the old door closer in Alhareeq 2", location: "Alhareeq 2", owner: "Facility", status: "Completed", eta: "2026-02-07", verification: "Yes" },
            { action: "Return extra Nova glass water cartons to the vendor", location: "2nd floor corridor", owner: "Vendor", status: "In Progress", eta: "TBD", verification: "", comment: "All cartons in the store, waiting for vendors reply" },
            { action: "Remove prayer rugs from HS Market offices", location: "Alaflaj", owner: "Facility", status: "In Progress", eta: "2026-02-07", verification: "", comment: "Employees keep bringing rugs for prayer" },
            { action: "Remove paper 'Female Toilet' sign", location: "Alaflaj - Wadi Aldwaser", owner: "Facility", status: "Completed", eta: "2026-02-09", verification: "Yes", afterPic: "https://drive.google.com/drive/folders/1WzRio66xnJiGLvvdK8UnHMrPJ5JY55ru" },
            { action: "Adjust new Male and Female toilet signs so text is centered", location: "All areas", owner: "Vendor", status: "In Progress", eta: "2026-02-11", verification: "" },
            { action: "Add the drop sign in Tabouk sign", location: "Corridors", owner: "Vendor", status: "Completed", eta: "2026-02-09", verification: "Yes" },
            { action: "Remove the carton cover from the window and install glass", location: "Rumah", owner: "Facility", status: "Completed", eta: "2026-02-09", verification: "Yes" },
            { action: "Organize and secure cables properly", location: "Alaflaj", owner: "Facility", status: "In Progress", eta: "2026-02-07", verification: "Yes" },
            { action: "Fix and maintain all planters/plants", location: "Rooftop", owner: "Vendor", status: "In Progress", eta: "2026-02-13", verification: "" },
            { action: "Install 2 hose holders in the rooftop for irrigation", location: "Rooftop", owner: "Vendor", status: "In Progress", eta: "2026-02-13", verification: "" },
            { action: "Remove all items placed on planters", location: "Rooftop", owner: "Facility", status: "Completed", eta: "2026-02-07", verification: "Yes" },
            { action: "Remove all unused boxes, old chairs, and unused furniture", location: "Rooftop", owner: "Facility", status: "In Progress", eta: "2026-02-14", verification: "", comment: "Approval needed from Finance" },
            { action: "Coordinate with the landlord regarding sewage air issue", location: "Rooftop", owner: "Landlord", status: "In Progress", eta: "TBD", verification: "" },
            { action: "Remove all ashtray from the rooftop", location: "Rooftop", owner: "Facility", status: "Completed", eta: "2026-02-05", verification: "Yes" },
            { action: "General cleaning for the rooftop area", location: "Rooftop", owner: "Facility", status: "Completed", eta: "2026-02-07", verification: "Yes" },
            { action: "Remove all unused old tools from the kitchen", location: "Alaflaj - Wadi Aldwaser", owner: "Facility", status: "Completed", eta: "2026-02-07", verification: "Yes" },
            { action: "Fix all the stains in the corridors", location: "Corridors", owner: "Landlord", status: "In Progress", eta: "TBD", verification: "" },
            { action: "Extend the business lounge table and remove the wooden panel", location: "Shaqra", owner: "Contractor", status: "In Progress", eta: "2026-02-07", verification: "", comment: "RFP Submitted" },
            { action: "Change the CEO office toilet (raise it)", location: "Ushaiqer", owner: "Contractor", status: "In Progress", eta: "2026-02-08", verification: "", comment: "Will require redoing the flooring and partially the wall" },
            { action: "Place frosting (remote controlled) for the CEO office door", location: "Ushaiqer", owner: "Contractor", status: "Completed", eta: "2026-02-08", verification: "Yes", comment: "Awaiting quotation and finalizing procurement process +20K" },
            { action: "Fall ceiling for legal room", location: "Almuzahmiyah", owner: "Facility", status: "Completed", eta: "2026-02-08", verification: "Yes", comment: "Need to align on maintenance for areas in Phase 2" },
            { action: "Remove the kitchen door in legal", location: "Almuzahmiyah", owner: "Facility", status: "Completed", eta: "2026-02-08", verification: "Yes" },
            { action: "Finalize the FM management system", location: "All cities", owner: "Facility", status: "In Progress", eta: "2026-02-08", verification: "", comment: "Request submitted to DH to activate Jira TTs" },
            { action: "Finalize new office location", location: "Riyadh - Dammam", owner: "Facility", status: "In Progress", eta: "2026-02-02", verification: "", comment: "To be discussed during the meeting" },
            { action: "Review the new FM agency contract", location: "All cities", owner: "Facility", status: "In Progress", eta: "2026-02-15", verification: "", comment: "Provide alternative suppliers" },
            { action: "Build a list of cleaning schedule per area", location: "Riyadh", owner: "Facility", status: "In Progress", eta: "2026-02-06", verification: "", comment: "Checklist ready, evaluation for HC required" },
            { action: "Schedule a weekly facilities walk in Riyadh", location: "Riyadh", owner: "Facility", status: "In Progress", eta: "2026-02-07", verification: "" },
            { action: "Remove two chairs , and four boxes of Ethernet cables", location: "Al-Madinah", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/1Yc0BAnERxxiypP6jJEoRjuJVPWTqCWIl", afterPic: "https://drive.google.com/drive/folders/1Yc0BAnERxxiypP6jJEoRjuJVPWTqCWIl" },
            { action: "Repairing electric plug", location: "Al-Qasem", owner: "Facility", status: "In Progress", eta: "2026-02-14", verification: "", comment: "Waiting for material quotation", beforePic: "https://drive.google.com/drive/folders/1G_02SF_6O54u26-leHA4QqNdn6v5eyO0" },
            { action: "Repairing the floor mat at the back of the office", location: "Rumah", owner: "Facility", status: "In Progress", eta: "2026-02-14", verification: "", comment: "Waiting for material", beforePic: "https://drive.google.com/drive/folders/1u_hIDWsEllL0FNEDAODoGbvJv28IEDrk" },
            { action: "Remove extra bean bag", location: "Tabok", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/1W_XcdRzQ2Uso0_4yFxWXS11v6_GfHxmV", afterPic: "https://drive.google.com/drive/folders/1W_XcdRzQ2Uso0_4yFxWXS11v6_GfHxmV" },
            { action: "Connecting the water cooler to electricity", location: "Eastern region", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/1ZF4TfisxZ8UqSQ0iL624u3436Uqxm5St", afterPic: "https://drive.google.com/drive/folders/1ZF4TfisxZ8UqSQ0iL624u3436Uqxm5St" },
            { action: "Plug the water cooler into the electricity", location: "Hayel", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/1Yc0BAnERxxiypP6jJEoRjuJVPWTqCWIl", afterPic: "https://drive.google.com/drive/folders/1Yc0BAnERxxiypP6jJEoRjuJVPWTqCWIl" },
            { action: "Remove extra drawers", location: "Jazan", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/1axf2ghEKXNdi-vMgl6qLzIwGhDFv_sc4", afterPic: "https://drive.google.com/drive/folders/1axf2ghEKXNdi-vMgl6qLzIwGhDFv_sc4" },
            { action: "Remove the vacuum cleaner next to the callboth", location: "Wadi Al-Dwaser", owner: "Facility", status: "In Progress", eta: "2026-02-15", verification: "", comment: "Waiting for Finance approval", beforePic: "https://drive.google.com/drive/folders/1q6PKG5fkUe8flONx8NQyI1rAy9Bp9_ET" },
            { action: "Remove useless cartoons near the callboth", location: "Wadi Al-Dwaser", owner: "Facility", status: "In Progress", eta: "2026-02-15", verification: "", comment: "Waiting for Finance approval", beforePic: "https://drive.google.com/drive/folders/1MrwWJAszadw-j5mFKi8Hj6cWA9h4Wdxt" },
            { action: "Remove the big cartoon inside server room", location: "Afeef", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/17Sub7Tr1LEh21Ewbi8fXhxvs2Ao3bvG6", afterPic: "https://drive.google.com/drive/folders/17Sub7Tr1LEh21Ewbi8fXhxvs2Ao3bvG6" },
            { action: "Clean the server room", location: "Afeef", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "" },
            { action: "Remove two cartoons beside the printer", location: "Al-Muzahmiya", owner: "Facility", status: "In Progress", eta: "2026-02-11", verification: "", beforePic: "https://drive.google.com/drive/folders/1bH-rllNtrGwtAD3yNSrwx8WUtWh447v1" },
            { action: "Remove 1 big cartoon full of papers and two HS painting", location: "Al-Duwadimi", owner: "Facility", status: "In Progress", eta: "2026-02-15", verification: "", comment: "Waiting for Finance approval", beforePic: "https://drive.google.com/drive/folders/1ZQNpwQylLLTpZMv9w0SYSk8Q0SmTwBjv" },
            { action: "Remove useless items near the callboth", location: "Al-kharj", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "", beforePic: "https://drive.google.com/drive/folders/1ADOYqJ99DIx9YCYFp69P2E0O_PMrfUza" },
            { action: "Provide electric socket to callboth", location: "Al-Deriyya", owner: "Facility", status: "In Progress", eta: "2026-02-15", verification: "", comment: "Waiting for material" },
            { action: "Remove useless items near the callboth", location: "Hayel", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/15HFL28au0benukgM4hzr1VMklkTAlgqT", afterPic: "https://drive.google.com/drive/folders/15HFL28au0benukgM4hzr1VMklkTAlgqT" },
            { action: "Find place for black circle tables", location: "Jazan", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/11JQITCPPuJSSgrVgf36tV79YGxFT9IrQ", afterPic: "https://drive.google.com/drive/folders/11JQITCPPuJSSgrVgf36tV79YGxFT9IrQ" },
            { action: "Plug the water cooler into the electricity", location: "Makkah", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/1x5K26oS1WBEvYsjGaGoLt0TUNeYgDX76", afterPic: "https://drive.google.com/drive/folders/1x5K26oS1WBEvYsjGaGoLt0TUNeYgDX76" },
            { action: "Remove extra drawer and useless items", location: "Eastern region", owner: "Facility", status: "Completed", eta: "2026-02-11", verification: "Yes", beforePic: "https://drive.google.com/drive/folders/1qvwYWt8aMXPoiHgzSOBe853WXBOKXe3S", afterPic: "https://drive.google.com/drive/folders/1qvwYWt8aMXPoiHgzSOBe853WXBOKXe3S" }
        ];

        // Calculate statistics
        const totalTasks = inspectionData.length;
        const completedTasks = inspectionData.filter(item => item.status === "Completed").length;
        const inProgressTasks = inspectionData.filter(item => item.status === "In Progress").length;
        
        // Calculate unique locations and photos
        const uniqueLocations = [...new Set(inspectionData.map(item => item.location))].length;
        const photoCount = inspectionData.filter(item => item.beforePic || item.afterPic).length;
        
        // Update summary cards
        document.getElementById("total-tasks").textContent = totalTasks;
        document.getElementById("completed-tasks").textContent = completedTasks;
        document.getElementById("inprogress-tasks").textContent = inProgressTasks;
        document.getElementById("total-photos").textContent = photoCount;
        
        // Calculate location frequency
        const locationCounts = {};
        inspectionData.forEach(item => {
            locationCounts[item.location] = (locationCounts[item.location] || 0) + 1;
        });
        
        // Sort locations by frequency
        const sortedLocations = Object.entries(locationCounts)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 8);
        
        // Populate top locations
        const topLocationsContainer = document.getElementById("topLocations");
        topLocationsContainer.innerHTML = '';
        sortedLocations.forEach(([location, count]) => {
            const locationItem = document.createElement("div");
            locationItem.className = "location-item";
            locationItem.innerHTML = `
                <div class="location-name"><i class="fas fa-map-pin" style="color: #0b2b4a; margin-right: 8px;"></i>${location}</div>
                <div class="location-count">${count} ${count === 1 ? 'task' : 'tasks'}</div>
            `;
            topLocationsContainer.appendChild(locationItem);
        });
        
        // Calculate owner statistics
        const ownerStats = {};
        const ownerCompleted = {};
        
        inspectionData.forEach(item => {
            ownerStats[item.owner] = (ownerStats[item.owner] || 0) + 1;
            if (item.status === "Completed") {
                ownerCompleted[item.owner] = (ownerCompleted[item.owner] || 0) + 1;
            }
        });
        
        // Owner colors and icons
        const ownerConfig = {
            'Facility': { color: '#0b2b4a', icon: 'fa-building' },
            'Contractor': { color: '#f39c12', icon: 'fa-hard-hat' },
            'Vendor': { color: '#3498db', icon: 'fa-truck' },
            'Landlord': { color: '#e74c3c', icon: 'fa-home' }
        };
        
        // Populate owner progress
        const ownerProgressContainer = document.getElementById("ownerProgress");
        ownerProgressContainer.innerHTML = '';
        
        Object.keys(ownerStats).sort().forEach(owner => {
            const total = ownerStats[owner];
            const completed = ownerCompleted[owner] || 0;
            const percent = Math.round((completed / total) * 100);
            const config = ownerConfig[owner] || { color: '#95a5a6', icon: 'fa-user' };
            
            const progressItem = document.createElement("div");
            progressItem.className = "progress-item";
            progressItem.innerHTML = `
                <div class="progress-header">
                    <span><i class="fas ${config.icon}" style="color: ${config.color}; margin-right: 8px;"></i>${owner}</span>
                    <span>${completed}/${total} tasks (${percent}%)</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${percent}%; background-color: ${config.color};"></div>
                </div>
            `;
            ownerProgressContainer.appendChild(progressItem);
        });
        
        // Populate pending tasks
        const pendingTasksContainer = document.getElementById("pendingTasks");
        const today = new Date("2026-02-12");
        
        function filterTasks(filterType) {
            const tabs = document.querySelectorAll('.filter-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            let filteredTasks = inspectionData.filter(item => {
                return item.status === "In Progress" && item.eta && item.eta !== "TBD" && item.eta !== "";
            });
            
            if (filterType === 'overdue') {
                filteredTasks = filteredTasks.filter(item => new Date(item.eta) < today);
            } else if (filterType === 'today') {
                filteredTasks = filteredTasks.filter(item => {
                    const etaDate = new Date(item.eta);
                    return etaDate.toDateString() === today.toDateString();
                });
            } else if (filterType === 'week') {
                const weekFromNow = new Date(today);
                weekFromNow.setDate(today.getDate() + 7);
                filteredTasks = filteredTasks.filter(item => {
                    const etaDate = new Date(item.eta);
                    return etaDate >= today && etaDate <= weekFromNow;
                });
            }
            
            displayTasks(filteredTasks);
        }
        
        function displayTasks(tasks) {
            pendingTasksContainer.innerHTML = '';
            
            // Sort by ETA
            tasks.sort((a, b) => new Date(a.eta) - new Date(b.eta));
            
            // Take top 8
            tasks.slice(0, 8).forEach(item => {
                const row = document.createElement("tr");
                const etaDate = new Date(item.eta);
                const diffTime = etaDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                let etaDisplay = item.eta;
                let etaClass = '';
                
                if (diffDays < 0) {
                    etaDisplay = `<span style="color: #e53e3e; font-weight: 800;">‚ö†Ô∏è ${item.eta} (${Math.abs(diffDays)} days overdue)</span>`;
                } else if (diffDays === 0) {
                    etaDisplay = `<span style="color: #e67e22; font-weight: 800;">üî¥ ${item.eta} (Today)</span>`;
                } else if (diffDays <= 3) {
                    etaDisplay = `<span style="color: #e67e22; font-weight: 800;">üü† ${item.eta} (${diffDays} days)</span>`;
                } else {
                    etaDisplay = `<span>${item.eta}</span>`;
                }
                
                // Check for photos
                const hasPhotos = item.beforePic || item.afterPic;
                const photoIcon = hasPhotos ? 
                    `<a href="${item.beforePic || item.afterPic}" target="_blank" class="drive-link"><i class="fas fa-camera" style="color: #0b2b4a;"></i></a>` : 
                    '<span style="color: #a0aec0;"><i class="fas fa-camera"></i></span>';
                
                row.innerHTML = `
                    <td style="font-weight: 600;">${item.action.length > 55 ? item.action.substring(0, 55) + "..." : item.action}</td>
                    <td><i class="fas fa-map-marker-alt" style="color: #0b2b4a; margin-right: 5px;"></i>${item.location}</td>
                    <td><span class="owner-badge">${item.owner}</span></td>
                    <td><span class="status-badge status-inprogress">In Progress</span></td>
                    <td>${etaDisplay}</td>
                    <td style="text-align: center;">${photoIcon}</td>
                `;
                pendingTasksContainer.appendChild(row);
            });
            
            if (tasks.length === 0) {
                const row = document.createElement("tr");
                row.innerHTML = '<td colspan="6" style="text-align: center; padding: 30px; color: #718096;"><i class="fas fa-check-circle" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>No pending tasks in this category</td>';
                pendingTasksContainer.appendChild(row);
            }
        }
        
        // Initial display - show all pending tasks
        const initialTasks = inspectionData.filter(item => {
            return item.status === "In Progress" && item.eta && item.eta !== "TBD" && item.eta !== "";
        });
        displayTasks(initialTasks);
        
        // Create timeline chart
        const ctx = document.getElementById('timelineChart').getContext('2d');
        
        // Count tasks by completion date
        const dateCounts = {};
        inspectionData.forEach(item => {
            if (item.status === "Completed" && item.eta && item.eta !== "") {
                const date = item.eta.substring(0, 10);
                dateCounts[date] = (dateCounts[date] || 0) + 1;
            }
        });
        
        // Add some sample dates for better visualization
        const allDates = ['2026-02-05', '2026-02-06', '2026-02-07', '2026-02-08', '2026-02-09', '2026-02-10', '2026-02-11'];
        const chartData = allDates.map(date => dateCounts[date] || 0);
        
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Feb 5', 'Feb 6', 'Feb 7', 'Feb 8', 'Feb 9', 'Feb 10', 'Feb 11'],
                datasets: [{
                    label: 'Tasks Completed',
                    data: chartData,
                    borderColor: '#2ecc71',
                    backgroundColor: 'rgba(46, 204, 113, 0.1)',
                    borderWidth: 4,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#0b2b4a',
                    pointBorderColor: 'white',
                    pointBorderWidth: 2,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: '#0b2b4a',
                        titleColor: 'white',
                        bodyColor: 'white',
                        padding: 12,
                        cornerRadius: 8
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        ticks: {
                            stepSize: 2,
                            font: { weight: '600' }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: { weight: '600' }
                        }
                    }
                }
            }
        });
        
        // Make filter function global
        window.filterTasks = filterTasks;
    </script>
</body>
</html>
